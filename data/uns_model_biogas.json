[
  {
    "concept": "Biogas Plant",
    "description": "Station d'épuration et de purification de biogaz produisant du biométhane ou du CH4 liquéfié (LBG)",
    "topic_template": "dt/iot/bgs/maintained/{plant_name}",
    "schema": {
      "device_identifier": {
        "type": "string",
        "description": "Identifiant unique de l'installation"
      },
      "plant_type": {
        "type": "string",
        "enum": ["BUU", "BUU_TBF"],
        "description": "Type d'installation - BUU (Biogas Upgrading Unit) ou BUU_TBF (avec Turbo Brayton pour liquéfaction)"
      }
    }
  },
  {
    "concept": "Biogas Configuration",
    "description": "Configuration des tags PLC et variables de l'installation biogaz avec métadonnées techniques",
    "topic_template": "dt/iot/bgs/maintained/{plant_name}/config",
    "schema": {
      "device_identifier": {
        "type": "string",
        "description": "Identifiant de l'installation"
      },
      "variables": {
        "type": "object",
        "description": "Dictionnaire des tags PLC avec leurs métadonnées",
        "patternProperties": {
          ".*": {
            "type": "object",
            "properties": {
              "comment": {
                "type": "string",
                "description": "Description technique du tag"
              },
              "group": {
                "type": "string",
                "description": "Groupe fonctionnel (A=Analogique, C=Commande/Status, D=Data)"
              },
              "unit": {
                "type": "string",
                "description": "Unité de mesure (bar, °C, Nm3/h, %, etc.)"
              },
              "origin": {
                "type": "string",
                "description": "Source du signal (ex: S73&400 pour Siemens S7-300/400)"
              },
              "address": {
                "type": "string",
                "description": "Adresse PLC (DB, registre, protocole)"
              },
              "log": {
                "type": "string",
                "enum": ["0", "1"],
                "description": "Indique si la variable est historisée (1) ou non (0)"
              }
            }
          }
        }
      }
    }
  },
  {
    "concept": "Biogas Real-time Data",
    "description": "Données temps réel de l'installation biogaz - état complet de tous les tags",
    "topic_template": "dt/iot/bgs/maintained/{plant_name}/full",
    "schema": {
      "device_identifier": {
        "type": "string",
        "description": "Identifiant de l'installation"
      },
      "variables": {
        "type": "object",
        "description": "Valeurs actuelles de tous les tags PLC"
      },
      "time": {
        "type": "string",
        "format": "date-time",
        "description": "Timestamp de la mesure"
      }
    }
  },
  {
    "concept": "Biogas Updates",
    "description": "Mises à jour incrémentales des variables qui ont changé",
    "topic_template": "dt/iot/bgs/maintained/{plant_name}/updates",
    "schema": {
      "device_identifier": {
        "type": "string",
        "description": "Identifiant de l'installation"
      },
      "variables": {
        "type": "object",
        "description": "Uniquement les variables qui ont changé depuis le dernier message"
      },
      "time": {
        "type": "string",
        "format": "date-time",
        "description": "Timestamp de la mise à jour"
      }
    }
  },
  {
    "concept": "BUU Process - Compression",
    "description": "Unité de compression du biogaz brut (BP vers MP)",
    "tag_examples": [
      {
        "tag": "C1101_ON_OFF",
        "type": "boolean",
        "description": "Compresseur BP ON/OFF"
      },
      {
        "tag": "PT0101",
        "type": "float",
        "unit": "bar",
        "description": "Pression entrée compresseur BP"
      },
      {
        "tag": "TT0101",
        "type": "float",
        "unit": "°C",
        "description": "Température entrée compresseur"
      },
      {
        "tag": "FT0102",
        "type": "float",
        "unit": "Nm3/h",
        "description": "Débit biogaz entrant"
      },
      {
        "tag": "VFD1101",
        "type": "float",
        "unit": "%",
        "description": "Vitesse variateur compresseur (% de cadence)"
      },
      {
        "tag": "C3101_CHILLER",
        "type": "boolean",
        "description": "Refroidisseur actif"
      }
    ]
  },
  {
    "concept": "BUU Process - H2S Removal",
    "description": "Élimination du sulfure d'hydrogène (désulfuration)",
    "tag_examples": [
      {
        "tag": "AI_AI8401_H2S",
        "type": "float",
        "unit": "ppm",
        "description": "Concentration H2S en entrée"
      },
      {
        "tag": "AI_AI8402_H2S",
        "type": "float",
        "unit": "ppm",
        "description": "Concentration H2S en sortie"
      },
      {
        "tag": "2100_CPT_H2S",
        "type": "float",
        "unit": "h",
        "description": "Compteur heures fonctionnement désulfuration"
      }
    ]
  },
  {
    "concept": "BUU Process - Membrane Separation",
    "description": "Séparation membranaire CO2/CH4 (1ère, 2ème, 3ème étage)",
    "tag_examples": [
      {
        "tag": "PT4111A",
        "type": "float",
        "unit": "bar",
        "description": "Pression entrée membranes étage 1A"
      },
      {
        "tag": "XEV510xA",
        "type": "boolean",
        "description": "Vanne module membrane 1-A"
      },
      {
        "tag": "Nber_Membranes_1st_active",
        "type": "integer",
        "description": "Nombre de modules membranes actifs étage 1"
      },
      {
        "tag": "PT5001",
        "type": "float",
        "unit": "bar",
        "description": "Pression perméat (CO2 rejeté)"
      },
      {
        "tag": "PT5101",
        "type": "float",
        "unit": "bar",
        "description": "Pression rétentat (CH4 purifié)"
      },
      {
        "tag": "AI_AT8461_CH4",
        "type": "float",
        "unit": "%",
        "description": "Concentration CH4 après membranes"
      },
      {
        "tag": "AI_AT8461_CO2",
        "type": "float",
        "unit": "%",
        "description": "Concentration CO2 après membranes"
      },
      {
        "tag": "Tx_Extraction_BUU_instantané",
        "type": "float",
        "unit": "%",
        "description": "Taux d'extraction instantané du BUU"
      }
    ]
  },
  {
    "concept": "BUU Process - Drying",
    "description": "Séchage du biométhane (élimination H2O)",
    "tag_examples": [
      {
        "tag": "TT1311",
        "type": "float",
        "unit": "°C",
        "description": "Température sécheur 1"
      },
      {
        "tag": "TT1331",
        "type": "float",
        "unit": "°C",
        "description": "Température sécheur 2"
      },
      {
        "tag": "PT5602",
        "type": "float",
        "unit": "bar",
        "description": "Pression après séchage"
      }
    ]
  },
  {
    "concept": "BUU Process - Quality Control",
    "description": "Contrôle qualité du biométhane avant injection",
    "tag_examples": [
      {
        "tag": "AI_AI8402_CH4",
        "type": "float",
        "unit": "%",
        "description": "CH4 final (>95%)"
      },
      {
        "tag": "AI_AI8402_CO2",
        "type": "float",
        "unit": "%",
        "description": "CO2 résiduel (<3%)"
      },
      {
        "tag": "AI_AI8402_O2",
        "type": "float",
        "unit": "%",
        "description": "O2 résiduel (<1%)"
      },
      {
        "tag": "PT6001",
        "type": "float",
        "unit": "bar",
        "description": "Pression injection réseau"
      },
      {
        "tag": "Info_Qual_Out_Ok",
        "type": "boolean",
        "description": "Qualité sortie conforme"
      }
    ]
  },
  {
    "concept": "BUU Performance - Production",
    "description": "Indicateurs de production biométhane",
    "tag_examples": [
      {
        "tag": "0100_CPT_BIO",
        "type": "float",
        "unit": "MWh",
        "description": "Compteur production biogaz total"
      },
      {
        "tag": "0100_CPT_BIO_J",
        "type": "float",
        "unit": "MWh",
        "description": "Production biogaz journalière"
      },
      {
        "tag": "6000_CPT_CH4",
        "type": "float",
        "unit": "MWh",
        "description": "Compteur production CH4 total"
      },
      {
        "tag": "6000_CPT_CH4_J",
        "type": "float",
        "unit": "MWh",
        "description": "Production CH4 journalière"
      },
      {
        "tag": "6000_CPT_INJ",
        "type": "float",
        "unit": "MWh",
        "description": "Compteur injection réseau total"
      },
      {
        "tag": "CADENCE_EN_COURS",
        "type": "float",
        "unit": "%",
        "description": "Cadence production actuelle"
      },
      {
        "tag": "AI_CADENCE_CLIENT",
        "type": "float",
        "unit": "%",
        "description": "Consigne cadence client"
      }
    ]
  },
  {
    "concept": "BUU Performance - Availability",
    "description": "Disponibilité et temps de marche",
    "tag_examples": [
      {
        "tag": "0000_CPT_MARCHE",
        "type": "float",
        "unit": "h",
        "description": "Compteur heures de marche total"
      },
      {
        "tag": "0000_CPT_ARR_CRT",
        "type": "float",
        "unit": "h",
        "description": "Compteur arrêts courts"
      },
      {
        "tag": "0000_CPT_ARR_FIA",
        "type": "float",
        "unit": "h",
        "description": "Compteur arrêts pour fiabilité"
      },
      {
        "tag": "Status_Demarree",
        "type": "boolean",
        "description": "Installation démarrée"
      },
      {
        "tag": "Status_Injection",
        "type": "boolean",
        "description": "En injection réseau"
      }
    ]
  },
  {
    "concept": "BUU Safety - TriSafe System",
    "description": "Système de sécurité TriSafe (détection gaz, ESD)",
    "tag_examples": [
      {
        "tag": "Trisafe_ESD0001",
        "type": "boolean",
        "description": "Arrêt d'urgence zone 1 actif"
      },
      {
        "tag": "Trisafe_ASH0001A_1",
        "type": "boolean",
        "description": "Détecteur CH4 haut zone A1"
      },
      {
        "tag": "Trisafe_ASL0002_1",
        "type": "boolean",
        "description": "Détecteur O2 bas"
      },
      {
        "tag": "Trisafe_Out_run_fan",
        "type": "boolean",
        "description": "Ventilation forcée active"
      }
    ]
  },
  {
    "concept": "TBF Process - Liquefaction",
    "description": "Turbo Brayton Field - Liquéfaction du CH4 pour produire du LBG (Liquefied Biogas)",
    "tag_examples": [
      {
        "tag": "PT1",
        "type": "float",
        "unit": "bar",
        "description": "Pression stockage LBG tank 1"
      },
      {
        "tag": "PT2",
        "type": "float",
        "unit": "bar",
        "description": "Pression stockage LBG tank 2"
      },
      {
        "tag": "STORAGE_PRESSURE",
        "type": "float",
        "unit": "bar",
        "description": "Pression moyenne stockage LBG"
      },
      {
        "tag": "LT1_PCENT",
        "type": "float",
        "unit": "%",
        "description": "Niveau tank 1 en %"
      },
      {
        "tag": "LT1_NM3",
        "type": "float",
        "unit": "Nm3",
        "description": "Volume LBG tank 1"
      },
      {
        "tag": "STORAGE_LEVEL_NM3",
        "type": "float",
        "unit": "Nm3",
        "description": "Volume total LBG stocké"
      },
      {
        "tag": "TT800",
        "type": "float",
        "unit": "°C",
        "description": "Température LBG avant détente (-23°C)"
      },
      {
        "tag": "TT801",
        "type": "float",
        "unit": "°C",
        "description": "Température LBG après détente (-162°C)"
      },
      {
        "tag": "FT800",
        "type": "float",
        "unit": "kg/h",
        "description": "Débit massique LBG produit"
      }
    ]
  },
  {
    "concept": "TBF Process - Compression",
    "description": "Compression du biométhane pour le TBF",
    "tag_examples": [
      {
        "tag": "MC_SPEED",
        "type": "float",
        "unit": "rpm",
        "description": "Vitesse compresseur principal (Main Compressor)"
      },
      {
        "tag": "MC",
        "type": "float",
        "unit": "%",
        "description": "Charge compresseur principal"
      },
      {
        "tag": "PT6200",
        "type": "float",
        "unit": "bar",
        "description": "Pression entrée compresseur HP"
      },
      {
        "tag": "PT100",
        "type": "float",
        "unit": "bar",
        "description": "Pression sortie compresseur"
      },
      {
        "tag": "TT100",
        "type": "float",
        "unit": "°C",
        "description": "Température sortie compresseur"
      }
    ]
  },
  {
    "concept": "TBF Process - Heat Exchangers",
    "description": "Échangeurs thermiques du cycle Brayton",
    "tag_examples": [
      {
        "tag": "TT6240",
        "type": "float",
        "unit": "°C",
        "description": "Température entrée échangeur chaud"
      },
      {
        "tag": "TT6241",
        "type": "float",
        "unit": "°C",
        "description": "Température sortie échangeur chaud"
      },
      {
        "tag": "TT6242",
        "type": "float",
        "unit": "°C",
        "description": "Température intermédiaire échangeur"
      },
      {
        "tag": "B6240",
        "type": "boolean",
        "description": "Soufflante refroidissement active"
      },
      {
        "tag": "H6240",
        "type": "float",
        "unit": "%",
        "description": "Puissance chauffage auxiliaire"
      }
    ]
  },
  {
    "concept": "TBF Process - Dryers & Adsorbers",
    "description": "Sécheurs et adsorbeurs CO2 du TBF",
    "tag_examples": [
      {
        "tag": "PT1210",
        "type": "float",
        "unit": "bar",
        "description": "Pression sécheur 1"
      },
      {
        "tag": "TT1210",
        "type": "float",
        "unit": "°C",
        "description": "Température sécheur 1"
      },
      {
        "tag": "PT4200",
        "type": "float",
        "unit": "bar",
        "description": "Pression adsorbeur actif"
      },
      {
        "tag": "TT4200",
        "type": "float",
        "unit": "°C",
        "description": "Température adsorbeur"
      },
      {
        "tag": "ANALYSER_CO2",
        "type": "float",
        "unit": "%",
        "description": "Concentration CO2 analyseur"
      },
      {
        "tag": "ANALYSER_CH4",
        "type": "float",
        "unit": "%",
        "description": "Concentration CH4 analyseur"
      }
    ]
  },
  {
    "concept": "TBF Process - Valves Control",
    "description": "Contrôle des vannes du cycle TBF",
    "tag_examples": [
      {
        "tag": "PV1",
        "type": "boolean",
        "description": "Vanne principale PV1"
      },
      {
        "tag": "PV11",
        "type": "boolean",
        "description": "Vanne recyclage PV11"
      },
      {
        "tag": "XV1200",
        "type": "boolean",
        "description": "Vanne sécheur 1 active"
      },
      {
        "tag": "XV4200",
        "type": "boolean",
        "description": "Vanne adsorbeur en service"
      },
      {
        "tag": "RFL_VALVE_FB",
        "type": "float",
        "unit": "%",
        "description": "Position vanne de reflux"
      }
    ]
  },
  {
    "concept": "TBF Safety - ESD & Interlocks",
    "description": "Sécurités et verrouillages du TBF",
    "tag_examples": [
      {
        "tag": "ESD_CABINET",
        "type": "boolean",
        "description": "Arrêt d'urgence armoire électrique actif"
      },
      {
        "tag": "ESD_TBF_MC",
        "type": "boolean",
        "description": "ESD compresseur principal actif"
      },
      {
        "tag": "STORAGE_PSHH",
        "type": "boolean",
        "description": "Alarme haute pression stockage"
      },
      {
        "tag": "STORAGE_LSHH",
        "type": "boolean",
        "description": "Alarme haut niveau stockage"
      },
      {
        "tag": "STORAGE_GAZ_DETECTOR",
        "type": "boolean",
        "description": "Détecteur gaz zone stockage actif"
      },
      {
        "tag": "LB_SAFETY_LOOP",
        "type": "boolean",
        "description": "Boucle sécurité Loading Bay active"
      }
    ]
  },
  {
    "concept": "TBF Performance - State Machine",
    "description": "États du processus TBF (séquenceur)",
    "tag_examples": [
      {
        "tag": "PLANT_S1000",
        "type": "integer",
        "description": "État installation (1004 = Running)"
      },
      {
        "tag": "STORAGE_S2000",
        "type": "integer",
        "description": "État stockage (2004 = Nominal)"
      },
      {
        "tag": "DRYER_1_S3200",
        "type": "integer",
        "description": "État sécheur 1 (3200 = Active)"
      },
      {
        "tag": "ADSORBER_1_S4200",
        "type": "integer",
        "description": "État adsorbeur 1 (4200 = Production)"
      },
      {
        "tag": "LIQUEFIER_S6000",
        "type": "integer",
        "description": "État liquéfacteur (6008 = Liquefying)"
      }
    ]
  },
  {
    "concept": "TBF Performance - Alarms",
    "description": "Alarmes et défauts du TBF",
    "tag_examples": [
      {
        "tag": "BUU_IN_FAULT_SUBSYSTEM_NOT_AVAILABLE",
        "type": "boolean",
        "description": "BUU en défaut ou non disponible"
      },
      {
        "tag": "HIGH_CO2_CONCENTRATION",
        "type": "boolean",
        "description": "Concentration CO2 trop élevée"
      },
      {
        "tag": "LOW_PRESSURE_DETECTED",
        "type": "boolean",
        "description": "Pression basse détectée"
      },
      {
        "tag": "LBG_LEVEL_MAX",
        "type": "boolean",
        "description": "Niveau LBG maximum atteint"
      },
      {
        "tag": "CHILLER_IN_FAULT",
        "type": "boolean",
        "description": "Groupe froid en défaut"
      }
    ]
  },
  {
    "concept": "Injection Network - Gas Quality",
    "description": "Qualité du gaz injecté dans le réseau (données externes GRTgaz/GRDF)",
    "tag_examples": [
      {
        "tag": "Inj_Biomethan_GC_CH4",
        "type": "float",
        "unit": "%",
        "description": "CH4 mesuré par chromatographe injection"
      },
      {
        "tag": "Inj_Biomethan_GC_CO2",
        "type": "float",
        "unit": "%",
        "description": "CO2 mesuré par chromatographe"
      },
      {
        "tag": "Inj_Biomethan_GC_PCI",
        "type": "float",
        "unit": "kWh/Nm3",
        "description": "Pouvoir Calorifique Inférieur"
      },
      {
        "tag": "Inj_Biomethan_GC_Wobbe",
        "type": "float",
        "unit": "kWh/Nm3",
        "description": "Indice de Wobbe"
      },
      {
        "tag": "Inj_EK220I_QM",
        "type": "float",
        "unit": "kg/h",
        "description": "Débit massique injection"
      },
      {
        "tag": "Inj_EK220I_Pressure",
        "type": "float",
        "unit": "bar",
        "description": "Pression injection réseau"
      }
    ]
  },
  {
    "concept": "Energy Consumption",
    "description": "Consommation énergétique de l'installation",
    "tag_examples": [
      {
        "tag": "3100_CPT_ELEC",
        "type": "float",
        "unit": "MWh",
        "description": "Compteur électricité total"
      },
      {
        "tag": "3100_CPT_ELEC_J",
        "type": "float",
        "unit": "MWh",
        "description": "Consommation électrique journalière"
      },
      {
        "tag": "AI_C3101_POWER",
        "type": "float",
        "unit": "kW",
        "description": "Puissance instantanée refroidisseur"
      }
    ]
  },
  {
    "concept": "Maintenance Counters",
    "description": "Compteurs de maintenance préventive",
    "tag_examples": [
      {
        "tag": "2100_MAINT_H2S_D_HEURE",
        "type": "integer",
        "description": "Heure prochaine maintenance désulfuration"
      },
      {
        "tag": "3100_MAINT_MP_D_JOUR",
        "type": "integer",
        "description": "Jour prochaine maintenance pompes MP"
      },
      {
        "tag": "6200_MAINT_HP_D_MOIS",
        "type": "integer",
        "description": "Mois prochaine maintenance pompes HP"
      },
      {
        "tag": "3100_FONCT_MP",
        "type": "float",
        "unit": "h",
        "description": "Heures fonctionnement pompes MP"
      }
    ]
  }
]
