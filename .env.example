# --- General MQTT Broker Configuration ---
# The URL of your broker.
MQTT_BROKER_HOST=demo.flashmq.org
MQTT_PORT=8883

# Use 'mqtt' or 'mqtts'
MQTT_PROTOCOL=mqtts 

# A unique client ID for the MQTT connection
CLIENT_ID=my-web-visualizer-app

# The MQTT topic(s) to subscribe to.
# For multiple topics, separate them with a comma.
# Example: "stark_industries/#,another/topic/tree/#,specific/device/status"
MQTT_TOPIC="stark_industries/#,spBv1.0/stark_industries/#"


# --- Authentication Method 1: Username & Password (for standard brokers) ---
# Leave these empty if using certificates
MQTT_USERNAME=
MQTT_PASSWORD=


# --- Authentication Method 2: Certificates (for AWS IoT or other MTLS brokers) ---
# Certificate Filenames (these files must be placed in the /certs folder)
# Leave these empty if using username/password
CERT_FILENAME=
KEY_FILENAME=
CA_FILENAME=flashmq-ca.crt


# --- Advanced TLS/ALPN Configuration ---
# Specify the ALPN protocol.
# For AWS IoT on port 443, use 'x-amzn-mqtt-ca'.
# Leave empty for most other brokers.
MQTT_ALPN_PROTOCOL=

# Set to 'false' to skip certificate verification (INSECURE, for dev only).
# Default is 'true'. If you set this to false, you don't need a CA_FILENAME.
MQTT_REJECT_UNAUTHORIZED=true


# --- Application & Simulator ---
SIMULATOR_ENABLED=true
PORT=8080

# --- Sparkplug B Support ---
# Set to 'true' to enable decoding of Sparkplug B Protobuf payloads.
# The topic must start with 'spBv1.0/' for decoding to be attempted.
SPARKPLUG_ENABLED=false

# --- Database Configuration ---
# Maximum database size in Megabytes.
# If exceeded, the oldest data will be pruned.
# Leave empty or comment out to disable the limit.
DUCKDB_MAX_SIZE_MB=100

# Number of old messages to delete when the size limit is reached.
# Note: The user requested "by steps of 50", this is interpreted as deleting a chunk of records.
# A larger chunk is more efficient. 500 is a reasonable default.
DUCKDB_PRUNE_CHUNK_SIZE=500

# Enable batch inserting for MQTT messages.
# This improves performance by grouping inserts instead of writing every message one-by-one.
# Also enables optimized JSON queries in the API.
DB_BATCH_INSERT_ENABLED=true

# How often (in milliseconds) the batch insert process should run.
DB_BATCH_INTERVAL_MS=2000

# Username for HTTP Basic Auth. Leave empty to disable.
HTTP_USER=
# Password for HTTP Basic Auth. Leave empty to disable.
HTTP_PASSWORD=

# Base path for reverse proxy deployment
# The path where the application is served from (e.g., /myapp).
# Must start with a slash and should NOT end with a slash.
# Leave empty or as "/" to run at the domain root.
BASE_PATH=/

# --- View & UI Configuration ---
# Enable or disable specific view tabs in the UI
VIEW_TREE_ENABLED=true
VIEW_SVG_ENABLED=true
VIEW_HISTORY_ENABLED=true
VIEW_MAPPER_ENABLED=true
VIEW_CHART_ENABLED=true

# The path to the SVG file to load, relative to the 'data' directory
SVG_FILE_PATH=view.svg

# --- Demo & Security Configuration ---
# Set to 'false' to hide the config page link and block its API/page access.
# Set to 'false' to disable the web-based configuration editor (/config.html)
VIEW_CONFIG_ENABLED=true

# Limits for demo mode. Set to 0 or leave empty to disable the limit.
MAX_SAVED_CHART_CONFIGS=1
MAX_SAVED_MAPPER_VERSIONS=1

# Ip addresses allowed to connect the APIs
API_ALLOWED_IPS=127.0.0.1,::1,172.17.0.1,172.18.0.1,::ffff:172.18.0.1,::ffff:172.21.0.1;

# MCP server config
# stdio or http
MCP_TRANSPORT=http
# port for http
MCP_PORT=3000